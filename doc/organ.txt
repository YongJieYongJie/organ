*organ.txt*		Minimal Orgmode environment for Vim and Neovim

==============================================================================
CONTENTS			*organ*

Introduction			|organ-introduction|
Configuration			|organ-configuration|
Bindings			|organ-bindings|
Folding				|organ-folding|
Meta-command			|organ-meta-command|
Prompt completion		|organ-prompt-completion|
Autocommands			|organ-autocommands|
Files				|organ-files|

==============================================================================
INTRODUCTION						*organ-introduction*

What is it ?				|organ-introduction-what|
Compatibility				|organ-introduction-compatibility|
Features				|organ-introduction-features|
Differences with standard orgmode	|organ-introduction-differences|
Dependencies				|organ-introduction-dependencies|
Why another org mode clone ?		|organ-introduction-why|

------------------------------------------------------------------------------
WHAT IS IT					*organ-introduction-what*

Organ generalizes the great concepts of Orgmode to Markdown and any
folding structure. It is primarily focused on editing these documents
with ease and agility.

------------------------------------------------------------------------------
COMPATIBILITY				*organ-introduction-compatibility*

Organ supports :

- org files
- markdown files
- any folded file

It is written in vimscript (VimL) and compatible with both Vim and Neovim.

------------------------------------------------------------------------------
FEATURES		    			*organ-introduction-features*

- folding based on headings in org and markdown files
- navigate in headings or list items hierarchy
  + next, previous : any level
  + forward, backward : same level as current one
  + parent heading, upper level
  + child heading, lower level :
    - loosely speaking : first headline of level + 1, forward
    - strictly speaking : must be in the current subtree
  + go to another headline with prompt completion of full path
- modify headings or list items
  + new headline or list item
  + select, yank, delete subtree
  + promote, demote heading or list item
  + move subtree up or down
  + move current subtree in another one (aka org-refile)
- expand shortcut to template (aka org-structure-template)
  + markdown support limited to code blocks
- create link with url completion
  + store url at cursor
- format tables
  + inside of table : align and add missing columns
  + outside of table : align following a pattern
- export in another format using
  + pandoc
  + emacs
  + asciidoc or asciidoctor
- convert headings and links org <-> markdown

Differences with standard orgmode~

- speed keys are also available in first char of list item line
- movements can
  + wrap around the end of the file
  + cross over a parent headline

------------------------------------------------------------------------------
DIFFERENCES WITH STANDARD ORG MODE	    *organ-introduction-differences*

## Differences with standard orgmode

- speed keys are also available in first char of list item line
- movements can
  + wrap around the end of the file
  + cross over a parent headline

------------------------------------------------------------------------------
DEPENDENCIES				*organ-introduction-dependencies*

This plugin should work out of the box, apart from a few advanced
features.

If you want to export your file to another format, you just need to have
pandoc installed, and the plugin takes care of the rest.  For org files,
it can also be done with emacs installed, at least for the formats
supported by orgmode.

If you want to navigate to an headline in another org or markdown file,
you can install [wheel](https://github.com/chimay/wheel) : it has a prompt
function with completion (launched with `<plug>(wheel-prompt-outline)`)
that looks for headlines in all orgmode or markdown files of a group.

------------------------------------------------------------------------------
WHY ANOTHER ORGMODE CLONE			*organ-introduction-why*

First of all, it is not intended as a clone, more of a loose adaptation.

The current orgmode plugins for (neo)vim that I could find are either :

- abandoned and not adapted for my usage
- written in python (which is fine but still a dependency)
- written in lua, which means they only work with neovim

I wanted to write a lightweight plugin in plain simple vimscript, with
minimal dependancies (most of it doesn't need anything else to work).

==============================================================================
CONFIGURATION						*organ-configuration*

Commented example			|organ-configuration-commented-example|
Persistent data				|organ-configuration-persistent-data|

------------------------------------------------------------------------------
COMMENTED EXAMPLE : >		*organ-configuration-commented-example*


  if ! exists("g:organ_loaded")
    " ---- initialize dicts
    let g:organ_config = {}
    let g:organ_config.list = {}
    let g:organ_config.links = {}
    let g:organ_config.templates = {}
    " ---- enable for every file if > 0
    let g:organ_config.everywhere = 0
    " ---- enable speed keys on first char of headlines and list items lines
    let g:organ_config.speedkeys = 1
    " ---- key to trigger <plug>(organ-previous)
    " ---- and go where speedkeys are available
    " ---- examples : <m-p> (default), [z
    let g:organ_config.previous = '[z'
    " ---- choose your mappings prefix
    let g:organ_config.prefix = '<m-c>'
    " ---- enable prefixless maps
    let g:organ_config.prefixless = 1
    " ---- prefixless maps in these modes (default)
    " ---- possible values : normal, insert
    let g:organ_config.prefixless_modes = ['normal', 'insert']
    " ---- enable only the prefixless maps you want
    " ---- see the output of :map <plug>(organ- to see available plugs
    " let g:organ_config.prefixless_plugs = ['organ-next', 'organ-backward', 'organ-forward']
    " ---- number of spaces to indent lists (default)
    let g:organ_config.list.indent_length = 2
    " ---- items chars in unordered list (default)
    let g:organ_config.list.unordered = #{ org : ['-', '+', '*'], markdown : ['-', '+']}
    " ---- items chars in ordered list (default)
    let g:organ_config.list.ordered = #{ org : ['.', ')'], markdown : ['.']}
    " ---- first item counter in an ordered list
    " ---- must be >= 0
    " ---- default 1
    let g:organ_config.list.counter_start = 1
  	" ---- number of stored links to keep (default)
    let g:organ_config.links.keep = 5
    " ---- shortcuts to expand templates
    " ---- examples from default settings
    " ---- run :echo g:organ_config.templates to see all
    " -- #+begin_center bloc
    let g:organ_config.templates['<c'] = 'center'
    " -- #+include: line
    let g:organ_config.templates['+i'] = 'include'
    " ---- custom maps
    nmap <c-cr> <plug>(organ-new)
    imap <c-cr> <plug>(organ-new)
    " -- to align visual selection
    vmap <m-a> <plug>(organ-format-table)
    nmap <tab> :Organ<space>
  endif
<

------------------------------------------------------------------------------
PERSISTENT DATA : >		*organ-configuration-persistent-data*

The following data :

- stored urls

are kept in the `g:ORGAN_STOPS` global variable. It is persistent across
(neo)vim sessions if you have `!` in your |'shada'| option.


==============================================================================
BINDINGS						*organ-bindings*

Speed keys				|organ-bindings-speed-keys|
Always available			|organ-bindings-always|
Prefixless				|organ-bindings-prefixless|
With prefix				|organ-bindings-with-prefix|
Custom					|organ-bindings-custom|

------------------------------------------------------------------------------
SPEED KEYS					*organ-bindings-speed-keys*

If you set the `g:organ_config.speedkeys` variable to a greater-than-zero
value in your init file, the speed keys become available. They are active
only in normal mode, when the cursor is on the first char of a headline
or a list item line. Here is a complete list :

- `<f1>`       : help
- `<pageup>`   : previous heading
- `<pagedown>` : next heading
- `<home>`     : backward heading of same level
- `<end>`      : forward heading of same level
- `+`          : upper, parent heading
- `-`          : lower, child heading, loosely speaking
- `_`          : lower, child heading, strictly speaking
- `w`          : where am I ? full headings path (part, chapter, section, subsection, ...)
- `^`          : go to headline, with prompt completion of full headings path
- `<tab>`      : cycle current fold visibility
- `<s-tab>`    : cycle all folds visibility
- `S`          : select subtree
- `Y`          : yank subtree
- `D`          : delete subtree
- `<del>`      : promote heading (and delete a level of indent)
- `<ins>`      : demote heading (and insert a level of indent)
- `H`          : promote subtree
- `L`          : demote subtree
- `U`          : move subtree up
- `D`          : move subtree down
- `M`          : move subtree in another one, with prompt completion
- `e`          : export with pandoc
- `E`          : export with emacs (works only in org files)

------------------------------------------------------------------------------
ALWAYS DEFINED					*organ-bindings-always*

Once you are on the first char of a headline, the speedkeys become
available. The plug `<plug>(organ-previous)` brings you precisely there,
and is therefore one of the most important maps. For this reason,
it's always defined, regardless of the prefixless setting. You can use
`g:organ_config.prefix` to choose the key that triggers it.

------------------------------------------------------------------------------
PREFIXLESS					*organ-bindings-prefixless*

If you set the `g:organ_config.prefixless` variable to a greater-than-zero
value in your init file, these bindings become available :

- `<M-p>`       : previous heading
- `<M-n>`       : next heading
- `<M-b>`       : previous heading of same level
- `<M-f>`       : next heading of same level
- `<M-u>`       : upper, parent heading
- `<M-l>`       : lower, child heading, loosely speaking : first headline of level + 1, forward
- `<M-S-l>`     : lower, child heading, strictly speaking
- `<M-w>`       : where am I ? full headings path (chapter, section, subsection, ...)
- `<M-h>`       : go to headline, with prompt completion of full headings path
- `<M-z>`       : cycle current fold visibility (like an improved |za|)
- `<M-S-z>`     : cycle all folds visibility
- `<M-CR>`      : new subtree or list item
- `<M-v>`       : select subtree
- `<M-y>`       : yank subtree
- `<M-d>`       : delete subtree
- `<M-left>`    : promote heading or list item
- `<M-right>`   : demote heading or list item
- `<M-S-left>`  : promote heading or list subtree
- `<M-S-right>` : demote heading or list subtree
- `<M-up>`      : move heading or list subtree up
- `<M-down>`    : move heading or list subtree down
- `<M-m>`       : move subtree in another one, with prompt completion
- `<M-x>`       : expand template
- `<M-s>`       : store url at cursor
- `<M-@>`       : create new link
- `<M-a>`       : in table : format (align) table ; outside : align following a pattern
- `<M-e>`       : export with pandoc
- `<M-S-e>`     : export with emacs (works only in org files)

You can customize `g:organ_config.prefixless_modes` to create prefixless
maps only in the modes you specify.

If there are some conflicts with your settings, you can restrict them
to a sublist. Example : >

 let g:organ_config.prefixless_plugs = ['organ-previous', 'organ-next']
<

You can list all available plugs with the command `:map <plug>(organ-`.

------------------------------------------------------------------------------
WITH PREFIX					*organ-bindings-with-prefix*

These are the same as the prefixless maps, but preceded by a prefix to
avoid conflicts with other plugins. Examples with the default prefix
`<M-c>` :

- `<M-c><M-p>`       : previous heading
- `<M-c><M-n>`       : next heading
- `<M-c><M-b>`       : previous heading of same level
- `<M-c><M-f>`       : next heading of same level

Some of them are inspired by orgmode, with `<C-...>` replaced by `<M-...>`.

You can customize the prefix by setting `g:organ_config.prefix` to the
key you want.

The prefix bindings are always available, regardless of the
`g:organ_config.prefixless` value.

------------------------------------------------------------------------------
CUSTOM						*organ-bindings-custom*

Plugs can be mapped as usual : >

 nmap <c-n> <plug>(organ-next)
<

If you wish to enable it only for certain filetypes, you can use autocommands : >

 autocmd FileType org,markdown nmap <buffer> <c-n> <plug>(organ-next)
<

This should have the same effect as writing : >

 nmap <buffer> <c-n> <plug>(organ-next)
<

in `ftplugin/org/main.vim` and `ftplugin/markdown/main.vim`, somewhere
in your runtimepath.

==============================================================================
FOLDING							*organ-folding*

Enable				|organ-folding-enable|
Markers				|organ-folding-markers|
Indent				|organ-folding-indent|

------------------------------------------------------------------------------
ENABLE						*organ-folding-enable*

Let's say you want to use this plugin in text, python and vim files.
Just add : >

 autocmd filetype text,vim,python call organ#void#enable ()
<

to your init file.

If you want to enable it for all filetypes, just set the everywhere
setting : >

 let g:organ_config.everywhere = 1
<

------------------------------------------------------------------------------
MARKERS						*organ-folding-markers*

When editing a folded file, this plugin expect folds delimited by markers
with level included, like `{{{1`, `{{{2`, and so on. The closing markers
`}}}` are useless and could in fact have side effects.

------------------------------------------------------------------------------
INDENT						*organ-folding-indent*

On files where `foldmethod=indent`, a limited support for basic navigation
is available.

==============================================================================
META COMMAND	 					*organ-meta-command*

The `:Organ` meta-command gives you access to almost all the plugin
features : >

 :Organ subcommand
<

Examples : >

 :Organ store-url
 :Organ export-with-pandoc
<

Completion is available for subcommands.

I suggest you map it to a convenient key. Example : >

 nnoremap <backspace> :Organ<space>
<

==============================================================================
PROMPT COMPLETION				*organ-prompt-completion*

Completion is available for :

- meta-command subcommands
- full path of headlines (goto, move to)
- stored links and links protocols (adding new link)
- language of source code block (template expansion)

It is intended to work roughly as with the combo org-goto and helm in
Emacs. A space is interpreted as a logical and, a `|` as a logical or. In
fact, it works exactly as in [wheel](https://github.com/chimay/wheel). For
further details, please refer to the
[completion page](https://github.com/chimay/wheel/wiki/completion) on the wheel wiki.

==============================================================================
AUTOCOMMANDS	 					*organ-autocommands*

If you copy some headings and links back and forth from org to markdown,
you can automatically convert the links at buffer write with the following
autocommands : >

 augroup organ
   autocmd!
   " ---- convert headings org <-> markdown
   autocmd bufwritepre *.md call organ#tree#org2markdown ()
   autocmd bufwritepre *.org call organ#tree#markdown2org ()
   " ---- convert links org <-> markdown
   autocmd bufwritepre *.md call organ#vine#org2markdown ()
   autocmd bufwritepre *.org call organ#vine#markdown2org ()
 augroup END
<

==============================================================================
FILES							*organ-files*

Plugin~


After~


Autoload~

Here is a list of files in `autoload/organ/`, and a brief description
of the modules within them.

| File              | Description                                        |
| ----------------- | -------------------------------------------------- |
| bird.vim          | Navigation in headings hierarchy                   |
| bush.vim          | Operations on lists hierarchy                      |
| centre.vim        | Commands & mappings                                |
| colibri.vim       | Navigation in lists hierarchy                      |
| complete.vim      | Completion functions                               |
| crystal.vim       | Internal constants                                 |
| diadem.vim        | Internal constants for meta command                |
| geode.vim         | Internal constants for plugs & maps                |
| kyusu.vim         | Filters for prompt & dedicated buffers             |
| nest.vim          | Navigation & operations on generic hierrachy       |
| origami.vim       | Folding                                            |
| perspective.vim   | content generators for prompt                      |
| pipe.vim          | export using pandoc or emacs                       |
| seed.vim          | structure templates (kind of lightweight snippets) |
| spiral.vim        | Golden ratio                                       |
| table.vim         | tables                                             |
| tree.vim          | Operations on headings hierarchy                   |
| utils.vim         | Small utils                                        |
| vine.vim          | Link management                                    |
| void.vim          | Initiaze & reset variables                         |

Ftplugin~

Doc~

doc/organ.txt : this file :)

Unused~

==============================================================================
vim:tw=78:ts=8:ft=help:norl:noet:nofen:
